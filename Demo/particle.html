<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Particle</title>
</head>
<style>
    body {
        margin: 0;
        overflow: hidden;
    }
</style>
<body>
<canvas id="canvas" width="1000" height="500"></canvas>
</body>
</html>
<script>
    class Particle {
        constructor(warp, imgsUrl, radius) {
            this.warp = warp//画布
            this.ctx = warp.getContext('2d')
            this.imgsUrl = imgssUrl//图片地址数组
            this.imgsObj = []//图片对象数组
            this.radius = radius//粒子半径
            this.index = 0//当前图片
            this.initz = 300
            this.dots = []
            this.init()
        }

        init() {
            this.warp.style.marginLeft = 'calc(50vw-500px)'
            this.warp.style.marginTop = 'calc(50vh-300px)'

            //限制小球半径
            if(this.wrap.width < 500 || this.warp.height > 300) {
                this.radius >= 4 ? this.radius = this.radius : this.radius = 4
            } else {
                this.radius >= 2 ? this.radius = this.radius : this.radius = 2
            }

            let promiseArr = this.imgsUrl.map(imgUrl => {
                return new Promise((resolve, reject) => {
                    let imgObj = new Image()
                    imgObj.onload = () => {
                        this.imgsObj.push(imgObj)
                        resolve()
                    }
                    //src 属性一定要写到 onload 的后面，否则程序在 IE 中会出错。
                    imgObj.src = imgUrl
                })
            })
            Promise.all(promiseArr).then(() => {
                this.picLoop()
            })
        }

        picLoop() {
            this.dots = []
            this.drawPic()
            this.toParticle()
            this.combineAnimate()
            this.index === this.imgsUrl.length - 1 ? this.index = 0 : ++this.index
        }

        drawPic() {

        }

        toParticle() {

        }

        combineAnimate() {

        }
    }
</script>